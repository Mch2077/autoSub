<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Layui</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="../assets/css/layui.css"  media="all">
  <link rel="stylesheet" href="../assets/css/view.css"/>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script src="https://ciphertrick.com/demo/jquerysession/js/jquerysession.js"></script>
  <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
</head>
<body class="layui-view-body">
    <div class="layui-content">
        <div class="layui-page-header">
            <div class="pagewrap">
                <span class="layui-breadcrumb">
                  <a href="">首页</a>
                  <a href="">视频中心</a>
                  <a><cite>视频上传</cite></a>
                </span>
                <h2 class="title">视频上传</h2>
            </div>
        </div>
        <div class="layui-row">
            <div class="layui-card">
                <div class="layui-card-body">
                  <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
                    <legend>拖拽上传</legend>
                  </fieldset> 
                  <center>
                    <div class="layui-upload-drag" id="select">
                    <i class="layui-icon">&#xe67c;</i>
                    <p>
                      点击上传，或将文件拖拽到此处
                      <br>现仅支持500MB以下的MP4视频文件
                    </p>
                    <div class="layui-hide" id="uploadDemoView">
                      <hr>
                      <img src="" alt="上传成功后渲染" style="max-width: 196px">
                    </div>
                    </div>
                    <br>
                    <button type="button" class="layui-btn" id="upload">开始上传</button>
                  </center> 
                </div>
            </div>
        </div>
    </div> 
            
  <script src="../assets/layui.all.js"></script>
  <!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
  <script>
  layui.use('upload', function(){
    var $ = layui.jquery
    ,upload = layui.upload;
    
    //拖拽上传mp4
    var uploadInst = upload.render({
      elem: '#select'
      ,url: 'http://localhost:8080/video/upload' //改成您自己的上传接口
      ,accept: 'video' //视频
      ,exts: 'mp4' //只允许上传mp4
      ,auto: false
      //,multiple: true
      ,bindAction: '#upload'
      ,size: 512000 //限制文件大小，单位 KB
      ,done: function(res){
        layer.msg('上传成功');
        layui.$('#uploadDemoView').removeClass('layui-hide').find('img').attr('src', res.files.file);
        console.log(res)
      }
      ,error: function(){
        //演示失败状态，并实现重传
        var demoText = $('#demoText');
        demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
        demoText.find('.demo-reload').on('click', function(){
          uploadInst.upload();
        });
      }
    });
  });
  </script>
</body>
</html>
